{{!
    This file is part of Moodle - http://moodle.org/

    Moodle is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    Moodle is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with Moodle.  If not, see <http://www.gnu.org/licenses/>.
}}
{{!
    Template for showing to the user the policy docs to agree.

    Classes required for JS:
    * policyactions

    Data attributes required for JS:
    -

    Context variables required for this template:
    * pluginbaseurl
    * myurl
    * sesskey
    * policies - policy array
    * privacyofficer - string with the privacy officer information
    * behalfuser - If behalfid is defined and valid, full name of the behalf user with a link to his/her profilr; null otherwise
}}

{{#messages}}{{{.}}}{{/messages}}

<form id="agreedocsform" method="post" action="{{myurl}}">
    <input type="hidden" name="sesskey" value="{{sesskey}}">

{{#behalfuser}}
<div class="clearfix">
    <div class="pull-right m-b-2">
        {{# str }} viewconsentpageforuser, tool_policy, {{{ . }}} {{/ str }}
    </div>
</div>
{{/behalfuser}}

<div class="clearfix">
    <div class="pull-left">
        <h2>{{# str }}consentpagetitle, tool_policy{{/ str }}</h2>
    </div>
</div>

<div class="clearfix m-t-2">
    <h3>{{# str }}agreepolicies, tool_policy {{/ str }}</h3>
</div>
<hr>


{{#policies}}

    <div class="agreedoc-policy clearfix m-t-2 m-b-1">
        <h3>{{{name}}}</h3>
        <div class="agreedoc-content">
            <div class="agreedoc-summary">
              {{{currentversion.summary}}}
            </div>
            <div class="agreedoc-msg">
                {{# str }}refertofullpolicytext, tool_policy, {{{policymodal}}} {{/ str }}
            </div>
        </div>
        <div class="agreedoc-form m-t-1">
            <div class="agreedoc-checkbox">
                <i class="icon fa fa-exclamation-circle text-danger fa-fw" title="{{# str }} required {{/ str }}" ></i>
                <input value="{{currentversionid}}" name="agreedoc[]" {{#versionagreed}}checked="{{.}}"{{/versionagreed}} type="checkbox">
                <label><strong>{{# str }}iagree, tool_policy, {{{name}}} {{/ str }}</strong></label>
            </div>
            <small>
            <ul class="agreedoc-msg list-unstyled">
                    {{#versionlangsagreed}}
                        <li>{{{.}}}</li>
                    {{/versionlangsagreed}}
                    {{#versionbehalfsagreed}}
                        <li>{{{.}}}</li>
                    {{/versionbehalfsagreed}}
            </ul>
            </small>
        </div>
    </div>

{{/policies}}

{{#privacyofficer}}
  <div class="agreedoc-officer well">
    {{{.}}}
  </div>
{{/privacyofficer}}

{{# str }}somefieldsrequired, form, <i class="icon fa fa-exclamation-circle text-danger fa-fw" title="{{# str }} required {{/ str }}" ></i>{{/ str }}
<hr>

<input type="submit" class="btn btn-primary" value={{#quote}}{{#str}} next {{/str}}{{/quote}}>
<input type="reset" class="btn btn-secondary" value={{#quote}}{{#str}} cancel {{/str}}{{/quote}}>

</form>

{{#js}}
// Initialise the JS for the modal window which displays the policy versions.
require(['tool_policy/policyactions'], function(ActionsMod) {
    var policyActions = new ActionsMod();
});
{{/js}}
